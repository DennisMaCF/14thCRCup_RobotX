<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>機器人電控系統架構圖</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { 
            background-color: #ffffff; 
            font-family: "Microsoft JhengHei", "Segoe UI", sans-serif;
            color: #1a1a1a;
        }
        .diagram-box {
            border: 2px solid #1a1a1a;
            background: white;
            padding: 8px;
            text-align: center;
            font-size: 12px;
            min-height: 48px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            z-index: 10;
        }
        .line-h {
            height: 2px;
            background-color: #1e293b;
            position: relative;
        }
        .line-h::after {
            content: '';
            position: absolute;
            right: -2px;
            top: -4px;
            border-top: 5px solid transparent;
            border-bottom: 5px solid transparent;
            border-left: 8px solid #1e293b;
        }
        .label-text {
            font-size: 9px;
            font-family: Consolas, monospace;
            background: white;
            padding: 0 4px;
            color: #475569;
            font-weight: bold;
            white-space: nowrap;
        }
    </style>
</head>
<body class="p-10 flex flex-col items-center">

    <div class="w-[1000px] border-2 border-slate-300 p-12 bg-white relative">
        <!-- 標題 -->
        <div class="mb-12 border-b-2 border-slate-900 pb-3 flex justify-between items-end">
            <div>
                <h1 class="text-2xl font-black tracking-widest">FIG 3-2: 機器人控制系統訊號流向圖</h1>
                <p class="text-[10px] text-slate-500 uppercase font-bold">14th CR-Cup Robot Project | All PWM Outputs from Mega</p>
            </div>
            <div class="text-[10px] text-slate-400 font-mono">Ver 2.3 | 2026-01-24</div>
        </div>

        <div class="grid grid-cols-12 gap-0 relative">
            
            <!-- 1. 感測層 (感知輸入) -->
            <div class="col-span-2 flex flex-col justify-start gap-6 mt-8">
                <div class="diagram-box border-slate-400 bg-slate-50">
                    <p class="font-bold text-slate-800">USB Cam A</p>
                    <p class="text-[9px] uppercase">自動巡航 (15s)</p>
                </div>
                <div class="diagram-box border-slate-400 bg-slate-50">
                    <p class="font-bold text-slate-800">USB Cam B</p>
                    <p class="text-[9px] uppercase">任務精準瞄準</p>
                </div>
                <div class="mt-4 text-center">
                    <span class="text-[9px] font-bold text-slate-400 border border-slate-200 px-2 py-0.5 rounded italic">Vision Input</span>
                </div>
            </div>

            <!-- 連接線: 感測器 -> 樹莓派 (USB 專線) -->
            <div class="col-span-1 flex flex-col justify-start gap-14 mt-12 px-2">
                <div class="line-h w-full"><span class="absolute -top-4 left-0 label-text">USB 3.0</span></div>
                <div class="line-h w-full"><span class="absolute -top-4 left-0 label-text">USB 3.0</span></div>
            </div>

            <!-- 2. 控制運算核心層 -->
            <div class="col-span-4 flex flex-col items-center">
                <!-- RPi (Master) - 僅處理影像與邏輯，無直接驅動輸出 -->
                <div class="diagram-box border-slate-800 w-full mb-8 py-6 shadow-sm">
                    <p class="font-black text-slate-900 text-lg uppercase tracking-tighter">Raspberry Pi 4B</p>
                    <p class="text-[10px] font-bold text-slate-600 uppercase tracking-widest">Master MCU (決策核心)</p>
                    <div class="mt-2 text-[9px] text-slate-400 font-mono">VISION PROCESSING & TASK LOGIC</div>
                </div>

                <!-- UART 通訊 (唯一的板對板溝通) -->
                <div class="flex flex-col items-center py-2">
                    <div class="w-0.5 h-6 bg-slate-800"></div>
                    <div class="px-4 py-1 border-2 border-slate-800 text-[10px] font-mono font-black bg-white shadow-sm italic">UART / SERIAL</div>
                    <div class="w-0.5 h-6 bg-slate-800"></div>
                </div>

                <!-- Mega (Slave) - 負責所有馬達的驅動輸出 -->
                <div class="diagram-box border-slate-800 w-full py-6 shadow-md bg-slate-50/50">
                    <p class="font-black text-slate-900 text-lg uppercase tracking-tighter">Arduino Mega 2560</p>
                    <p class="text-[10px] font-bold text-slate-600 uppercase tracking-widest">Slave MCU (執行單元)</p>
                    <div class="mt-2 text-[9px] text-slate-400 font-mono">ALL HARDWARE PWM/SIGNAL OUTPUT</div>
                </div>
            </div>

            <!-- 3. 執行機構層 (所有線路均由 Mega 出發) -->
            <div class="col-span-5 relative">
                <div class="absolute inset-0 flex flex-col justify-end gap-2.5 pl-4 pb-2">
                    
                    <!-- 底盤驅動馬達 (D2-D5 PWM) -->
                    <div class="flex items-center">
                        <div class="line-h w-20"><span class="absolute -top-4 left-2 label-text">PWM_D2~D5</span></div>
                        <div class="diagram-box w-44 ml-2 border-slate-900 font-black text-[11px]">
                            底盤驅動馬達 (1-4)
                            <span class="text-[9px] text-slate-500 font-bold mt-0.5 uppercase italic">直流無刷 BLDC</span>
                        </div>
                    </div>

                    <div class="h-1 text-[10px] text-slate-300 ml-20">-------------------</div>

                    <!-- 機構馬達群 (由 Mega 控制) -->
                    <div class="flex items-center">
                        <div class="line-h w-20"><span class="absolute -top-4 left-2 label-text">PWM_D6</span></div>
                        <div class="diagram-box w-44 ml-2 bg-white text-[11px]">
                            旋轉海綿系統
                            <span class="text-[9px] text-slate-500 font-normal italic">一般直流 DC</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="line-h w-20"><span class="absolute -top-4 left-2 label-text">PWM_D7</span></div>
                        <div class="diagram-box w-44 ml-2 bg-white text-[11px]">
                            升降台機構
                            <span class="text-[9px] text-slate-500 font-normal italic">減速直流 Gear DC</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="line-h w-20"><span class="absolute -top-4 left-2 label-text">STEP / DIR</span></div>
                        <div class="diagram-box w-44 ml-2 border-slate-900 bg-white text-[11px] font-bold">
                            夾娃娃爪機構
                            <span class="text-[9px] text-slate-500 font-normal italic">步進 Stepper</span>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <div class="line-h w-20"><span class="absolute -top-4 left-2 label-text">PULSE / SIG</span></div>
                        <div class="diagram-box w-44 ml-2 border-slate-900 bg-white text-[11px] font-bold">
                            秧苗套筒組
                            <span class="text-[9px] text-slate-500 font-normal italic">步進 / 伺服</span>
                        </div>
                    </div>

                </div>
            </div>

        </div>

        <!-- 底部圖例與說明 -->
        <div class="mt-20 pt-6 border-t border-slate-200 flex justify-between items-center">
            <div class="flex gap-6 text-[10px] font-bold text-slate-500">
                <div class="flex items-center gap-1"><div class="w-3 h-3 border border-slate-400 bg-white"></div> 控制指令流</div>
                <div class="flex items-center gap-1"><div class="w-3 h-3 border border-slate-400 bg-slate-50"></div> 硬體驅動端</div>
                <div class="flex items-center gap-1"><div class="w-3 h-3 border border-slate-400 bg-blue-50"></div> 影像輸入端</div>
            </div>
            <div class="text-right">
                <p class="text-[10px] font-black text-slate-800 uppercase italic">Engineering Architecture v2.3</p>
                <p class="text-[9px] text-slate-400">All logic and signal synchronization strictly handled by Slave MCU.</p>
            </div>
        </div>
    </div>

    <!-- 流程說明摘要 -->
    <div class="w-[1000px] mt-8 bg-white p-6 border-2 border-dashed border-slate-200 rounded text-xs text-slate-500 leading-relaxed">
        <strong>架構重點摘要：</strong><br>
        1. <strong>Raspberry Pi</strong> 作為 Master，僅負責雙攝影機之高階影像處理與運動路徑規劃，並下達指令。<br>
        2. <strong>Arduino Mega</strong> 作為 Slave，接收 UART 數據後，轉為 8 組具體的驅動脈波，為系統唯一的執行輸出點。<br>
        3. <strong>馬達規格：</strong> 底盤驅動(BLDC)、海綿(DC)、升降台(Geared DC)、夾爪(Stepper)、套筒(Stepper/Servo)。
    </div>

</body>
</html>